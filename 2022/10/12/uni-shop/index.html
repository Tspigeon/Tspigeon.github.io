
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>uni-shop - Tspigeon &#39;s blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="My blog,uni-shop一个小程序购物平台
1.tabBar下方导航栏的样式如图：

要设置tabBar的样式，需要在pages.json中使用”tabBar”属性书写
主要是list显示导航栏的列表
12,"> 
    <meta name="author" content="Tspigeon"> 
    <link rel="alternative" href="atom.xml" title="Tspigeon &#39;s blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="uni-shop - Tspigeon &#39;s blog"/>
    <meta name="twitter:description" content="My blog,uni-shop一个小程序购物平台
1.tabBar下方导航栏的样式如图：

要设置tabBar的样式，需要在pages.json中使用”tabBar”属性书写
主要是list显示导航栏的列表
12,"/>
    
    
    
    
    <meta property="og:site_name" content="Tspigeon &#39;s blog"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="uni-shop - Tspigeon &#39;s blog"/>
    <meta property="og:description" content="My blog,uni-shop一个小程序购物平台
1.tabBar下方导航栏的样式如图：

要设置tabBar的样式，需要在pages.json中使用”tabBar”属性书写
主要是list显示导航栏的列表
12,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

<meta name="generator" content="Hexo 6.0.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">Tspigeon &#39;s blog</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://yoursite.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">uni-shop</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">uni-shop</h1>
        <div class="stuff">
            <span>十月 12, 2022</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/uni-app/" rel="tag">uni-app</a></li></ul>


        </div>
        <div class="content markdown">
            <h1 id="uni-shop"><a href="#uni-shop" class="headerlink" title="uni-shop"></a>uni-shop</h1><p>一个小程序购物平台</p>
<h2 id="1-tabBar"><a href="#1-tabBar" class="headerlink" title="1.tabBar"></a>1.tabBar</h2><p>下方导航栏的样式如图：</p>
<p><img src="https://img-blog.csdnimg.cn/be0d831b1a3d4db6859d282f8c6b5739.png" alt="tabBar"></p>
<p>要设置tabBar的样式，需要在pages.json中使用”tabBar”属性书写</p>
<p>主要是list显示导航栏的列表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&quot;tabBar&quot;: &#123;</span><br><span class="line">//选中文字颜色</span><br><span class="line">&quot;selectedColor&quot;: &quot;#b50e03&quot;,</span><br><span class="line">//未选中时文字的颜色</span><br><span class="line">&quot;color&quot;:&quot;#ccc&quot;,</span><br><span class="line">//导航栏配置信息</span><br><span class="line">&quot;list&quot;: [</span><br><span class="line">	&#123;</span><br><span class="line">		&quot;text&quot;: &quot;首页&quot;,</span><br><span class="line">		&quot;pagePath&quot;: &quot;pages/index/index&quot;,</span><br><span class="line">		//图标</span><br><span class="line">		&quot;iconPath&quot;: &quot;./static/icon/home.png&quot;,</span><br><span class="line">		//选中时候的图标</span><br><span class="line">		&quot;selectedIconPath&quot;: &quot;./static/icon/home-active.png&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		&quot;text&quot;: &quot;资讯&quot;,</span><br><span class="line">		&quot;pagePath&quot;: &quot;pages/news/news&quot;,</span><br><span class="line">		&quot;iconPath&quot;: &quot;./static/icon/news.png&quot;,</span><br><span class="line">		&quot;selectedIconPath&quot;: &quot;./static/icon/news-active.png&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		&quot;text&quot;: &quot;购物车&quot;,</span><br><span class="line">		&quot;pagePath&quot;: &quot;pages/cart/cart&quot;,</span><br><span class="line">		&quot;iconPath&quot;: &quot;./static/icon/cart.png&quot;,</span><br><span class="line">		&quot;selectedIconPath&quot;: &quot;./static/icon/cart-active.png&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		&quot;text&quot;: &quot;会员&quot;,</span><br><span class="line">		&quot;pagePath&quot;: &quot;pages/member/member&quot;,</span><br><span class="line">		&quot;iconPath&quot;: &quot;./static/icon/member.png&quot;,</span><br><span class="line">		&quot;selectedIconPath&quot;: &quot;./static/icon/member-active.png&quot;</span><br><span class="line">	&#125;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="2-首页"><a href="#2-首页" class="headerlink" title="2.首页"></a>2.首页</h2><p>对于node搭建的后台使用<code>node +文件名.js</code>的方式运行</p>
<p>首先要打开phpstudy提供一个本地服务器环境</p>
<p>如果phpstudy的数据库爆红，有可能是端口占用的情况，包括本机mysql正在运行在3306端口上</p>
<p>如果端口没有占用还是爆红，可能是没有打开mysql服务，在电脑的service中寻找mysql然后点击运行</p>
<h3 id="1-获取轮播图"><a href="#1-获取轮播图" class="headerlink" title="1.获取轮播图"></a>1.获取轮播图</h3><p>我使用node搭建的后台，然后发送请求获取数据</p>
<p>发送请求我们已经很熟悉了，使用uni.request</p>
<p>这里success中的this.swipers中的this指向需要依靠箭头函数实现，不然就要使用保存this的方法</p>
<p>uni.showToast是一个常用的提示框，类似于alert</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">getSwipers()&#123;</span><br><span class="line">	uni.request(&#123;</span><br><span class="line">		url: &quot;http://localhost:8082/api/getlunbo&quot;,</span><br><span class="line">		//成功的回调</span><br><span class="line">		success: res =&gt; &#123;</span><br><span class="line">			if(res.data.status !== 0)&#123;</span><br><span class="line">				//状态码错误 获取数据失败</span><br><span class="line">				return uni.showToast(&#123;</span><br><span class="line">					title: &quot;获取数据失败&quot;</span><br><span class="line">				&#125;)</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">				this.swipers= res.data.message</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在OnLoad的钩子上调用这个函数就可以实现获取每次加载发送请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onLoad() &#123;</span><br><span class="line">	this.getSwipers()</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<p>但是我们现在要做的是对请求的封装</p>
<p>新建目录<code>util</code>，然后创建<code>api.js</code></p>
<p>里面实现对promise的封装：</p>
<p>这样所有的请求都可以使用myRequest封装好的promise，减少代码的重复度，解耦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//设置基础地址</span><br><span class="line">const BASE_URL = &quot;http://localhost:8082&quot;;</span><br><span class="line">//暴露封装好的myRequest</span><br><span class="line">export const myRequest = (options) =&gt;&#123;</span><br><span class="line">	return new Promise((resolve,reject)=&gt;&#123;</span><br><span class="line">		uni.request(&#123;</span><br><span class="line">			url: BASE_URL+options.url,</span><br><span class="line">			method: options.method || &quot;GET&quot;,</span><br><span class="line">			data: options.data || &#123;&#125;,</span><br><span class="line">			//成功的回调</span><br><span class="line">			success: res =&gt; &#123;</span><br><span class="line">				if(res.data.status !== 0)&#123;</span><br><span class="line">					//状态码错误 获取数据失败</span><br><span class="line">					return uni.showToast(&#123;</span><br><span class="line">						title: &quot;获取数据失败&quot;</span><br><span class="line">					&#125;)</span><br><span class="line">			&#125;</span><br><span class="line">			resolve(res)</span><br><span class="line">		&#125;,</span><br><span class="line">		fail: err =&gt; &#123;</span><br><span class="line">			uni.showToast(&#123;</span><br><span class="line">				title: &quot;获取数据失败&quot;</span><br><span class="line">			&#125;)</span><br><span class="line">			//提示数据获取失败并调用reject</span><br><span class="line">			reject(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后把这个挂载到全局——<code>main.js</code>中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//引入myRequest</span><br><span class="line">import &#123; myRequest &#125; from &quot;util/api.js&quot;</span><br><span class="line">//全局挂载到原型上</span><br><span class="line">Vue.prototype.$myreq = myRequest</span><br></pre></td></tr></table></figure>

<p>这样Vue的原型上就多了一个<code>$myreq</code></p>
<p>我们发送请求的时候直接调用这个函数然后传入options对象就可以了</p>
<p>因为获取的是一个promise对象，所以我们需要使用async包裹一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">async getSwipers()&#123;</span><br><span class="line">	//封装好之后调用获取 res</span><br><span class="line">	const res = await this.$myreq(&#123;</span><br><span class="line">		url: &quot;/api/getlunbo&quot;,</span><br><span class="line">	&#125;)</span><br><span class="line">	this.swipers =  res.data.message</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-实现轮播图"><a href="#2-实现轮播图" class="headerlink" title="2.实现轮播图"></a>2.实现轮播图</h3><p>使用uni自带的swiper组件实现轮播</p>
<p>使用v-for进行循环生成item</p>
<p>然后动态绑定<code>img</code>属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 轮播图组件 --&gt;</span><br><span class="line">&lt;swiper indicator-dots circular&gt;</span><br><span class="line">	&lt;!-- 每一个的轮播item --&gt;</span><br><span class="line">	&lt;swiper-item v-for=&quot;item in swipers&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">		&lt;!-- 轮播的内容 --&gt;</span><br><span class="line">		&lt;image :src=&quot;item.img&quot;&gt;&lt;/image&gt;</span><br><span class="line">	&lt;/swiper-item&gt;</span><br><span class="line">&lt;/swiper&gt;</span><br></pre></td></tr></table></figure>



<h3 id="3-首页导航栏"><a href="#3-首页导航栏" class="headerlink" title="3.首页导航栏"></a>3.首页导航栏</h3><p>首先引入字体和图标以及相关样式，引用在app.vue中</p>
<p>这种字体图标的使用是在class中写 <code>iconfont +name</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;nav&quot;&gt;</span><br><span class="line">	&lt;view class=&quot;nav_item&quot;&gt;</span><br><span class="line">		&lt;view class=&quot;iconfont icon-ziyuan&quot;&gt;&lt;/view&gt;</span><br><span class="line">		&lt;text&gt;超市&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">	&lt;view class=&quot;nav_item&quot;&gt;</span><br><span class="line">		&lt;view class=&quot;iconfont icon-guanyuwomen&quot;&gt;&lt;/view&gt;</span><br><span class="line">		&lt;text&gt;联系我们&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">	&lt;view class=&quot;nav_item&quot;&gt;</span><br><span class="line">		&lt;view class=&quot;iconfont icon-tupian&quot;&gt;&lt;/view&gt;</span><br><span class="line">		&lt;text&gt;社区图片&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">	&lt;view class=&quot;nav_item&quot;&gt;</span><br><span class="line">		&lt;view class=&quot;iconfont icon-shipin&quot;&gt;&lt;/view&gt;</span><br><span class="line">		&lt;text&gt;学习视频&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>我们样式使用<code>flex</code>布局，弹性布局将盒子转换为弹性盒子</p>
<p><code>line-height</code>拉高我们的每一行高度，让字体图标下移</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 导航栏</span><br><span class="line">.nav&#123;</span><br><span class="line">	display: flex;</span><br><span class="line">	.nav_item&#123;</span><br><span class="line">		width: 25%;</span><br><span class="line">		text-align: center;</span><br><span class="line">		view&#123;</span><br><span class="line">			width: 120rpx;</span><br><span class="line">			height: 120rpx;</span><br><span class="line">			border-radius: 60rpx;</span><br><span class="line">			line-height: 120rpx;</span><br><span class="line">			margin: 10rpx auto;</span><br><span class="line">			background-color: #b50e03;</span><br><span class="line">			color: #fff;</span><br><span class="line">			font-size: 50rpx;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		text&#123;</span><br><span class="line">			font-size: 30rpx;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-热门商品推荐"><a href="#4-热门商品推荐" class="headerlink" title="4.热门商品推荐"></a>4.热门商品推荐</h3><p>先写一个简单的title</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 热门商品 --&gt;</span><br><span class="line">&lt;view class=&quot;hot_goods&quot;&gt;</span><br><span class="line">	&lt;view class=&quot;title&quot;&gt;热门商品&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>然后是相关样式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//热门商品</span><br><span class="line">.hot_goods&#123;</span><br><span class="line">	background-color: #eee;</span><br><span class="line">	.title&#123;</span><br><span class="line">		height: 100rpx;</span><br><span class="line">		line-height: 100rpx;</span><br><span class="line">		background: #fff;</span><br><span class="line">		text-align: center;</span><br><span class="line">		color: $uni-color-shop;</span><br><span class="line">		letter-spacing: 40rpx;</span><br><span class="line">		margin: 10rpx 0rpx;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为<code>#b50e03</code>这种红色用的很多，所以我们在uni.css文件中添加一项</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/* 行为相关颜色 */</span><br><span class="line">$uni-color-shop: #b50e03;</span><br></pre></td></tr></table></figure>

<p>然后我们设置color的时候就可以使用<code>$uni-color-shop</code>代替</p>
<p>接下来写一下热门商品列表的样式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;goodList&quot;&gt;</span><br><span class="line">	&lt;view class=&quot;goodItem&quot;&gt;</span><br><span class="line">		&lt;image src=&quot;&quot;&gt;&lt;/image&gt;</span><br><span class="line">		&lt;view class=&quot;price&quot;&gt;</span><br><span class="line">			&lt;text&gt;￥123&lt;/text&gt;</span><br><span class="line">			&lt;text&gt;￥234&lt;/text&gt;</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">		&lt;view class=&quot;name&quot;&gt;</span><br><span class="line">			swpu</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;view class=&quot;goodItem&quot;&gt;</span><br><span class="line">		&lt;image src=&quot;&quot;&gt;&lt;/image&gt;</span><br><span class="line">		&lt;view class=&quot;price&quot;&gt;</span><br><span class="line">			&lt;text&gt;￥123&lt;/text&gt;</span><br><span class="line">			&lt;text&gt;￥234&lt;/text&gt;</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">		&lt;view class=&quot;name&quot;&gt;</span><br><span class="line">			swpu</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>样式：其中有很多样式设置很巧妙</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">.goodList&#123;</span><br><span class="line">	//开启flex</span><br><span class="line">	display: flex;</span><br><span class="line">	//换行</span><br><span class="line">	flex-wrap: wrap;</span><br><span class="line">	//贴边对齐</span><br><span class="line">	justify-content: space-between;</span><br><span class="line">	padding: 0 15rpx;</span><br><span class="line">	.goodItem&#123;</span><br><span class="line">		background: #fff;</span><br><span class="line">		width: 355rpx;</span><br><span class="line">		margin: 20rpx 0;</span><br><span class="line">		padding: 15rpx;</span><br><span class="line">		box-sizing: border-box;</span><br><span class="line">		image&#123;</span><br><span class="line">			width: 80%;</span><br><span class="line">			height:300rpx;</span><br><span class="line">			display: block;</span><br><span class="line">			margin: 0 auto;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		.price&#123;</span><br><span class="line">			color: $uni-color-shop;</span><br><span class="line">			font-size: 30rpx;</span><br><span class="line">			text:nth-child(2)&#123;//单独设置第二个text样式</span><br><span class="line">				color: #ccc;</span><br><span class="line">				font-size: 28rpx;</span><br><span class="line">				margin-left: 17rpx;</span><br><span class="line">				text-decoration: line-through;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		.name&#123;</span><br><span class="line">			font-size: 28rpx;</span><br><span class="line">			line-height: 50rpx;</span><br><span class="line">			padding-top: 10rpx;</span><br><span class="line">			padding-bottom: 15rpx;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-热门商品数据渲染"><a href="#5-热门商品数据渲染" class="headerlink" title="5.热门商品数据渲染"></a>5.热门商品数据渲染</h3><p>简单的发一个请求然后v-for遍历</p>
<p>data中写一个hotGoods数组准备存放我们的数据</p>
<p>然后发送请求接收数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 获取热门商品列表</span><br><span class="line">async getHotGoods()&#123;</span><br><span class="line">	const res = await this.$myreq(&#123;</span><br><span class="line">		url: &quot;/api/getgoods?pageindex=1&quot;,</span><br><span class="line">	&#125;)</span><br><span class="line">	this.hotGoods = res.data.message</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到数据然后遍历goodItem</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;goodItem&quot; v-for=&quot;item in hotGoods&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">	&lt;image src=&quot;http://img13.360buyimg.com/n7/jfs/t1/131119/27/26844/20436/631938aaEcb21d77f/c6b07559e6a6db21.jpg&quot;&gt;&lt;/image&gt;</span><br><span class="line">	&lt;view class=&quot;price&quot;&gt;</span><br><span class="line">		&lt;text&gt;￥&#123;&#123;item.sell_price&#125;&#125;&lt;/text&gt;</span><br><span class="line">		&lt;text&gt;￥&#123;&#123;item.market_price&#125;&#125;&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">	&lt;view class=&quot;name&quot;&gt;</span><br><span class="line">		&#123;&#123;item.title&#125;&#125;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<h3 id="6-热门数据组件化"><a href="#6-热门数据组件化" class="headerlink" title="6.热门数据组件化"></a>6.热门数据组件化</h3><p>新建一个components目录，下面加入goodList组件，将index中商品列表的部分移植过来</p>
<h3 id="7-实现导航栏跳转"><a href="#7-实现导航栏跳转" class="headerlink" title="7.实现导航栏跳转"></a>7.实现导航栏跳转</h3><p>对于导航栏，我们首先需要做一个更新，变成需要使用v-for循环得到</p>
<p>在data中建立一个navs数组存放数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">navs: [</span><br><span class="line">	&#123;</span><br><span class="line">		icon: &#x27;iconfont icon-ziyuan&#x27;,</span><br><span class="line">		title: &#x27;超市&#x27;,</span><br><span class="line">		url: &#x27;/pages/goods/goods&#x27;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		icon: &#x27;iconfont icon-guanyuwomen&#x27;,</span><br><span class="line">		title: &#x27;联系我们&#x27;,</span><br><span class="line">		url: &#x27;/pages/contact/contact&#x27;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		icon: &#x27;iconfont icon-tupian&#x27;,</span><br><span class="line">		title: &#x27;社区图片&#x27;,</span><br><span class="line">		url: &#x27;/pages/pics/pics&#x27;</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		icon: &#x27;iconfont icon-shipin&#x27;,</span><br><span class="line">		title: &#x27;学习视频&#x27;,</span><br><span class="line">		url: &#x27;/pages/videos/videos&#x27;</span><br><span class="line">	&#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>然后更改导航栏的结构，使用v-for得到数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;nav&quot;&gt;</span><br><span class="line">	&lt;view class=&quot;nav_item&quot; v-for=&quot;(item,index) in navs&quot; :key=&quot;index&quot;&gt;</span><br><span class="line">		&lt;view :class=&quot;item.icon&quot;&gt;&lt;/view&gt;</span><br><span class="line">		&lt;text&gt;&#123;&#123;item.title&#125;&#125;&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>执行跳转需要一个点击事件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 导航栏 --&gt;</span><br><span class="line">&lt;view class=&quot;nav&quot;&gt;</span><br><span class="line">	&lt;view class=&quot;nav_item&quot; v-for=&quot;(item,index) in navs&quot; :key=&quot;index&quot; @click=&quot;navItemClick(item.url)&quot;&gt;</span><br><span class="line">		&lt;view :class=&quot;item.icon&quot;&gt;&lt;/view&gt;</span><br><span class="line">		&lt;text&gt;&#123;&#123;item.title&#125;&#125;&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>拿到每一个item的url之后可以调用navigateTo进行跳转</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//点击导航栏触发跳转</span><br><span class="line">navItemClick(url)&#123;</span><br><span class="line">	uni.navigateTo(&#123;</span><br><span class="line">		url</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们对跳转的页面进行处理：新建一个goods页面作为跳转目的地，引用goodList组件，这里主要是pageindex中的数字不能写死，需要根据用户的需求进行调整</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;view class=&quot;good_List&quot;&gt;</span><br><span class="line">		&lt;goodList :goods=&quot;goods&quot;&gt;&lt;/goodList&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">	import goodList from &#x27;../../components/goodList/goodList.vue&#x27;</span><br><span class="line">	export default &#123;</span><br><span class="line">		components: &#123;&quot;goodList&quot;:goodList&#125;,</span><br><span class="line">		data() &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				pageindex : 1,</span><br><span class="line">				goods : []</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			async getGoods()&#123;</span><br><span class="line">				const res =  await this.$myreq(&#123;</span><br><span class="line">					url:&#x27;/api/getGoods?pageindex=&#x27;+this.pageindex</span><br><span class="line">				&#125;)</span><br><span class="line">				</span><br><span class="line">				this.goods = res.data.message</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		onLoad() &#123;</span><br><span class="line">			this.getGoods()</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">	.goodList&#123;</span><br><span class="line">		background-color: #eee;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>当用户滑到底部的时候，调用一个函数获取新的页面，改造一下我们的getGoods函数</p>
<p>我一开始用的push</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//实现数组的叠加</span><br><span class="line">this.goods.push(...res.data.message)</span><br></pre></td></tr></table></figure>

<p>后面发现直接使用展开运算符是一样的效果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">async getGoods()&#123;</span><br><span class="line">	const res =  await this.$myreq(&#123;</span><br><span class="line">		url:&#x27;/api/getGoods?pageindex=&#x27;+this.pageindex</span><br><span class="line">	&#125;)</span><br><span class="line">	//实现数组的叠加</span><br><span class="line">	this.goods = [...this.goods, ...res.data.message]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是我们这里会显示其他页的数据，通过改变我们的pageindex，然后触底的时候发送请求</p>
<p>我们首先写一个，没有更多数据的提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;isOver&quot; v-show=&quot;flag&quot;&gt;-----我也是有底线的-----&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>这个提示的显示由<strong>请求到的数据是不是为空</strong>决定，没有数据了我们达到底部也不发送请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">onReachBottom() &#123;</span><br><span class="line">	this.pageindex++</span><br><span class="line">	if(this.flag == false)&#123;</span><br><span class="line">	this.getGoods()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>然后在getGoods中判断，没有数据了就将flag为true，将提示显示出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">async getGoods()&#123;</span><br><span class="line">	const res =  await this.$myreq(&#123;</span><br><span class="line">		url:&#x27;/api/getGoods?pageindex=&#x27;+this.pageindex</span><br><span class="line">	&#125;)</span><br><span class="line">	//判断是否还有数据</span><br><span class="line">	if(res.data.message.length == 0)&#123;</span><br><span class="line">		this.flag = true</span><br><span class="line">	&#125;</span><br><span class="line">	//实现数组的叠加</span><br><span class="line">	// this.goods.push(...res.data.message)</span><br><span class="line">	this.goods = [...this.goods, ...res.data.message]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们设置一个下拉刷新，在pages.json中打开我们的PullDownRefresh</p>
<p>在下拉的生命周期中重置数组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//下拉刷新</span><br><span class="line">async onPullDownRefresh() &#123;</span><br><span class="line">	this.pageindex == 1</span><br><span class="line">	this.goods = []</span><br><span class="line">	this.flag = false</span><br><span class="line">	//等待请求发送成功后消除刷新效果</span><br><span class="line">	await this.getGoods()</span><br><span class="line">	uni.stopPullDownRefresh()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果getGoods执行完毕就触发stopPullDownRefresh，还有一种方法是将stopPullDownRefresh设置成getGoods的回调</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">this.getGoods(()=&gt;&#123;</span><br><span class="line">	uni.stopPullDownRefresh()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">callBack &amp;&amp; callBack()</span><br><span class="line"></span><br><span class="line">//getGoods中接收回调</span><br><span class="line">getGoods(callBack)</span><br></pre></td></tr></table></figure>

<h3 id="8-contact页面的map"><a href="#8-contact页面的map" class="headerlink" title="8. contact页面的map"></a>8. contact页面的map</h3><p>这里启用在manifest.json中的h5配置中的定位和地图，需要输入一个应用key，在腾讯地图中申请便可</p>
<p>将key设置成map</p>
<p>就可以在我们的程序中使用<code>&lt;map&gt;</code>标签使用</p>
<p>map中有两个位置属性 分别代表经纬度，一般将经纬度数据放在data中如何动态绑定</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;map class=&quot;map&quot; :latitude=&quot;latitude&quot; :longitude=&quot;longitude&quot;&gt;&lt;/map&gt;</span><br></pre></td></tr></table></figure>

<p>还可以设置坐标点等，写的时候本来想把iconpath写成绝对路径的，但是一直报错，改成相对路径才正确</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;map class=&quot;map&quot; :latitude=&quot;latitude&quot; :longitude=&quot;longitude&quot; :markers=&quot;markers&quot;&gt;&lt;/map&gt;</span><br><span class="line"></span><br><span class="line">//markers</span><br><span class="line">markers: [</span><br><span class="line">    &#123;</span><br><span class="line">    	//id必写</span><br><span class="line">        id:1,</span><br><span class="line">        latitude: 30.832711,</span><br><span class="line">        longitude: 104.190908,</span><br><span class="line">        iconPath: &quot;../../static/icon/logo.png&quot;,</span><br><span class="line">        //设置透明度</span><br><span class="line">        alpha: 0.7</span><br><span class="line">    &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<p>然后拨打电话可以调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">phone()&#123;</span><br><span class="line">	uni.makePhoneCall(&#123;</span><br><span class="line">		phoneNumber:&quot;110-112-113&quot;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-pics页面"><a href="#9-pics页面" class="headerlink" title="9.pics页面"></a>9.pics页面</h3><p>这个页面需要在左侧设置一个滚动条，右侧是展示的图片等信息</p>
<h4 id="9-1-左侧"><a href="#9-1-左侧" class="headerlink" title="9.1 左侧"></a>9.1 左侧</h4><p>作为左侧的滚动条我们可以设置为：</p>
<p>需要注意这里从内到位的高度都需要设置成100%</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;pics&quot;&gt;</span><br><span class="line">	&lt;scroll-view class=&quot;left&quot; scroll-y=&quot;true&quot;&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">		&lt;view&gt;家具生活&lt;/view&gt;</span><br><span class="line">	&lt;/scroll-view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">//样式</span><br><span class="line">page&#123;</span><br><span class="line">	height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.pics&#123;</span><br><span class="line">	height: 100%;</span><br><span class="line">	.left&#123;</span><br><span class="line">		width: 100px;</span><br><span class="line">		height: 100%;</span><br><span class="line">		border: solid 1px #eee;</span><br><span class="line">		view&#123;</span><br><span class="line">			height: 60px;</span><br><span class="line">			width: 100%;</span><br><span class="line">			line-height: 60px;</span><br><span class="line">			text-align: center;</span><br><span class="line">			font-size: 30rpx;</span><br><span class="line">			border-top: solid 1px #eee;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后就是设置左侧数据渲染和数据展示</p>
<p>因为接口有问题，所以这里的数据我写死了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">cates:[</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;家居生活&quot;,</span><br><span class="line">			id:1,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;摄影设计&quot;,</span><br><span class="line">			id:2,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;装饰&quot;,</span><br><span class="line">			id:3,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;服饰&quot;,</span><br><span class="line">			id:4,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;装修&quot;,</span><br><span class="line">			id:5,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;电气&quot;,</span><br><span class="line">			id:6,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;管道&quot;,</span><br><span class="line">			id:7,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;户型设计&quot;,</span><br><span class="line">			id:8,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;医药&quot;,</span><br><span class="line">			id:9,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;书籍&quot;,</span><br><span class="line">			id:10,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;管道&quot;,</span><br><span class="line">			id:11,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;户型设计&quot;,</span><br><span class="line">			id:12,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;医药&quot;,</span><br><span class="line">			id:13,</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			title:&quot;书籍&quot;,</span><br><span class="line">			id:14,</span><br><span class="line">		&#125;</span><br><span class="line">	],</span><br><span class="line">	isActive: 1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;pics&quot;&gt;</span><br><span class="line">	&lt;scroll-view class=&quot;left&quot; scroll-y=&quot;true&quot;&gt;</span><br><span class="line">		&lt;view  :class=&quot;isActive===item.id?&#x27;active&#x27; : &#x27;&#x27;&quot; v-for=&quot;(item,index) in cates&quot; :key=&quot;item.id&quot; @click=&quot;changeItem(item.id)&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/view&gt;</span><br><span class="line">	&lt;/scroll-view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>这里得到的数据由cates遍历得到，这里我开始犯了一个错误，将三元表达式写成了这个样子</p>
<p><code>&quot;isActive===id?&#39;active&#39; : &#39;&#39;&quot;</code>，我们需要知道这个时候id是item中的属性，能这样写的情况取决于v-for</p>
<p> <code>v-for=&quot;(item,index) in cates&quot; :key=&quot;id&quot; </code>，如果这样子写，那么就可以将三元表达式写成<code>&quot;isActive===index?&#39;active&#39; : &#39;&#39;&quot;</code></p>
<p>对于v-for来说，我们得到的数据只有in前面的哪几个</p>
<h4 id="9-2-右侧"><a href="#9-2-右侧" class="headerlink" title="9.2 右侧"></a>9.2 右侧</h4><p>右侧的数据每个item的数据渲染部分</p>
<p>依然使用<code>scroll-view</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;scroll-view class=&quot;right&quot; scroll-y&gt;</span><br><span class="line">	&lt;view  v-for=&quot;item in details&quot; :key=&quot;item.id&quot; class=&quot;item&quot;&gt;</span><br><span class="line">		&lt;image src=&quot;../../static/icon/logo.png&quot;&gt;&lt;/image&gt;</span><br><span class="line">		&lt;text&gt;&#123;&#123;item.title&#125;&#125;&lt;/text&gt;</span><br><span class="line">		&lt;text&gt;&#123;&#123;item.zhaiyao&#125;&#125;&lt;/text&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/scroll-view&gt;</span><br></pre></td></tr></table></figure>

<p>主要是样式设计，需要开启一个flex布局</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">.pics&#123;</span><br><span class="line">	height: 100%;</span><br><span class="line">	display: flex;</span><br><span class="line">	.left&#123;</span><br><span class="line">		---</span><br><span class="line">	&#125;</span><br><span class="line">	.right&#123;</span><br><span class="line">		height: 100%;</span><br><span class="line">		width: 520rpx;</span><br><span class="line">		//设置间隔距离</span><br><span class="line">		margin: 10rpx auto;</span><br><span class="line">		.item&#123;</span><br><span class="line">			img&#123;</span><br><span class="line">				height: 520rpx;</span><br><span class="line">				weight: 520rpx;</span><br><span class="line">				border-radius: 5px;</span><br><span class="line">			&#125;</span><br><span class="line">			text&#123;</span><br><span class="line">				font-size: 30rpx;</span><br><span class="line">				line-height: 60rpx;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现预览图片</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//预览图片</span><br><span class="line">previewImg(current_img)&#123;</span><br><span class="line">	//提取details数组中的img_url属性</span><br><span class="line">	const urls = this.details.map(item =&gt; &#123;</span><br><span class="line">		return item.img_url</span><br><span class="line">	&#125;)</span><br><span class="line">	uni.previewImage(&#123;</span><br><span class="line">		urls,</span><br><span class="line">		current: current_img,</span><br><span class="line">		indicator: &quot;default&quot;,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-资讯"><a href="#3-资讯" class="headerlink" title="3.资讯"></a>3.资讯</h2><p>对于资讯页面我们依然先搭建结构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;news&quot;&gt;</span><br><span class="line">	&lt;view class=&quot;news_item&quot; v-for=&quot;item in news&quot; :key=&quot;item.id&quot; &gt;</span><br><span class="line">		&lt;image src=&quot;../../static/icon/cart-active.png3&quot;&gt;&lt;/image&gt;</span><br><span class="line">		&lt;view class=&quot;right&quot;&gt;</span><br><span class="line">			&lt;view class=&quot;title&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/view&gt;</span><br><span class="line">			&lt;view class=&quot;info&quot;&gt;</span><br><span class="line">				&lt;text&gt;发表时间：&#123;&#123;item.add_time&#125;&#125;&lt;/text&gt;</span><br><span class="line">				&lt;text&gt;浏览：&#123;&#123;item.click&#125;&#125;&lt;/text&gt;</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">//样式</span><br><span class="line">	.news&#123;</span><br><span class="line">	.news_item&#123;</span><br><span class="line">		//开启弹性</span><br><span class="line">		display: flex;</span><br><span class="line">		padding: 10rpx 20rpx;</span><br><span class="line">		border-bottom: 1px solid $uni-color-shop;</span><br><span class="line">		image&#123;</span><br><span class="line">			min-width: 200rpx;</span><br><span class="line">			max-width: 200rpx;</span><br><span class="line">			height: 150rpx;</span><br><span class="line">		&#125;</span><br><span class="line">		.right&#123;</span><br><span class="line">			display: flex;</span><br><span class="line">			margin-left: 15rpx;</span><br><span class="line">			//切换方式为竖轴</span><br><span class="line">			flex-direction: column;</span><br><span class="line">			//两边对齐</span><br><span class="line">			justify-content: space-between;</span><br><span class="line">			.title&#123;</span><br><span class="line">				font-size: 30rpx;</span><br><span class="line">			&#125;</span><br><span class="line">			.info&#123;</span><br><span class="line">				font-size: 24rpx;</span><br><span class="line">				text:nth-child(2)&#123;</span><br><span class="line">					margin-left: 30rpx;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后就是熟悉的接口和获取参数，然后遍历list得到数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">	data() &#123;</span><br><span class="line">		return &#123;</span><br><span class="line">			news:[],</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	onLoad() &#123;</span><br><span class="line">		this.getNews();</span><br><span class="line">	&#125;,</span><br><span class="line">	methods: &#123;</span><br><span class="line">		async getNews()&#123;</span><br><span class="line">			const res = await this.$myreq(&#123;</span><br><span class="line">				url: &quot;/api/getnewslist&quot;,</span><br><span class="line">			&#125;)</span><br><span class="line">			</span><br><span class="line">			this.news = res.data.message</span><br><span class="line">			console.log(this.news)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们点击某一条资讯的时候可以进入资讯的详情页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;news_item&quot; @click=&quot;goDetails(item.id)&quot; v-for=&quot;item in news&quot; :key=&quot;item.id&quot; &gt;</span><br></pre></td></tr></table></figure>

<p>传入id作为每个资讯的标识</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">goDetails(id)&#123;</span><br><span class="line">	uni.navigateTo(&#123;</span><br><span class="line">		url: `/pages/news-detail/news-detail?id=$&#123;id&#125;`</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们跳转至<code>news-detail</code>页面</p>
<p>进入之后第一件事情当然是发请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">async getNewsDetails()&#123;</span><br><span class="line">	const res = await this.$myreq(&#123;</span><br><span class="line">		url: `/api/getnew/$&#123;this.id&#125;`</span><br><span class="line">	&#125;)</span><br><span class="line">	</span><br><span class="line">	this.details = res.data.message[0]</span><br><span class="line">	this.details.add_time = this.formatDate(this.details.add_time)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>与众不同的是这个时候返回的内容数据是html</p>
<p>所以我们展示的时候就不能使用插值语法，<strong>使用<code>v-html</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;content&quot; v-html=&quot;details.content&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>或者使用<code>&lt;rich-text :nodes=&quot;参数&quot;&gt;</code>富文本也可以解决</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;content&quot;&gt;内容：</span><br><span class="line">&lt;!-- 引入富文本解析html --&gt;</span><br><span class="line">	&lt;rich-text :nodes=&quot;Dinfo.content&quot;&gt;&lt;/rich-text&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>



<h2 id="4-获取商品详情"><a href="#4-获取商品详情" class="headerlink" title="4.获取商品详情"></a>4.获取商品详情</h2><p>点击goodList组件中的图片可以进行跳转</p>
<p>需要用到子组件向父组件传值，使用emit绑定自定义事件，并通过第二个参数进行传值</p>
<p>因为goodList在index首页和goods页面都有用到，所以这两个父页面都需要绑定对应的自定义事件</p>
<p>而且他们需要获得goodList中的<code>item.id</code></p>
<p>然后在两个父页面中使用navigate跳转到详情页面，并把数据<code>id</code>通过OnLoad中的options传入</p>
<p>详情页面拿到<code>id</code>后向服务器端发送请求，获取的数据用于轮播图，基本信息展示</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link"
		data-enable="false"
        data-ae="false"
        data-ci=""
        data-cs=""
        data-r=""
        data-o=""
        data-a=""
        data-d="false"
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
