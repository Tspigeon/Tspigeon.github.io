

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://imgse.com/i/p9yX0tP">
  <link rel="icon" href="https://imgse.com/i/p9yX0tP">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Tspigeon">
  <meta name="keywords" content="">
  
    <meta name="description" content="One Piece的时代终将来临">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue3">
<meta property="og:url" content="http://yoursite.com/2022/06/06/Vue3/index.html">
<meta property="og:site_name" content="Tspigeon &#39;s blog">
<meta property="og:description" content="One Piece的时代终将来临">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/bfaf423d6bff48238ebcb67470dfa442.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/f980aa564e374167936dbf70089df3ba.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/6a16a4068642451599baeaa80939acff.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/52b001236b4a44d3a4ccd04717c00103.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/970ce1664f8348f7b256f950b8eb78c0.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/4a93f07bf2ac4cee80cbd864888ab3e2.png">
<meta property="article:published_time" content="2022-06-05T16:00:00.000Z">
<meta property="article:modified_time" content="2023-04-11T13:51:55.706Z">
<meta property="article:author" content="Tspigeon">
<meta property="article:tag" content="vue">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/bfaf423d6bff48238ebcb67470dfa442.png">
  
  
  
  <title>Vue3 - Tspigeon &#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/toubudaziji.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"yoursite.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 100vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>No pigeon</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://s1.ax1x.com/2023/05/12/p9yX20s.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Vue3"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-06 00:00" pubdate>
          2022年6月6日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          16k 字
        
      </span>
    

    

    
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Vue3</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Vue3"><a href="#Vue3" class="headerlink" title="Vue3"></a>Vue3</h1><h2 id="1-创建一个vue3项目"><a href="#1-创建一个vue3项目" class="headerlink" title="1.创建一个vue3项目"></a>1.创建一个vue3项目</h2><h3 id="1-1-cli创建"><a href="#1-1-cli创建" class="headerlink" title="1.1 cli创建"></a>1.1 cli创建</h3><p>cli创建要求vue版本高于4.5.0，我们可以在cmd中通过<code>vue -V</code>查看</p>
<p>然后按照脚手架的方式创建：<code>vue create -name</code></p>
<p>进入之后选择vue3脚手架即可</p>
<h3 id="1-2-vite创建"><a href="#1-2-vite创建" class="headerlink" title="1.2 vite创建"></a>1.2 vite创建</h3><p>vite是新一代的前端构建工具，由vue团队开发，为了挑战webpack的地位</p>
<p>vite的速度更快更轻量级，使用vite构建工程的方法如下：</p>
<p><img src="https://img-blog.csdnimg.cn/bfaf423d6bff48238ebcb67470dfa442.png" srcset="/img/loading.gif" lazyload alt="vite"></p>
<p>启动不再是<code>npm run serve</code>而是<code>npm run dev</code></p>
<p>我们会发现启动快了很多，但是vite是<strong>等你进入网址再进行动态加载页面</strong></p>
<h2 id="2-vue3结构"><a href="#2-vue3结构" class="headerlink" title="2.vue3结构"></a>2.vue3结构</h2><p>vue3中的<code>main.js</code>中的代码和<code>vue2</code>不同，它使用一个轻量级的app管理组件，提供了挂载和卸载功能</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//引入调用vue的工厂函数 createApp</span><br><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><br><br><span class="hljs-comment">// 创建一个app对象，类似于vue2中的vm，但是app更轻</span><br><span class="hljs-keyword">const</span> app = createApp(App)<br><br><span class="hljs-comment">// 挂载</span><br>app.mount(<span class="hljs-string">&#x27;#app&#x27;</span>)<br><br><span class="hljs-comment">// 卸载</span><br>app.unmount(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>在组件中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 可以不再需要一个根标签 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Vue logo&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./assets/logo.png&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">HelloWorld</span> <span class="hljs-attr">msg</span>=<span class="hljs-string">&quot;Welcome to Your Vue.js App&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure>



<p>tips：我们可以使用#region和#endRegion括住注释的两端，实现折叠功能</p>
<h2 id="3-composition-API"><a href="#3-composition-API" class="headerlink" title="3.composition API"></a>3.composition API</h2><h3 id="3-1-set-up"><a href="#3-1-set-up" class="headerlink" title="3.1 set up"></a>3.1 set up</h3><p><code>set up</code>是一个配置项，它的值是一个函数，里面存放了数据，方法等（感觉有点像模块化的vuex）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-keyword">let</span> name = <span class="hljs-string">&quot;tony&quot;</span>;<br>  <span class="hljs-keyword">let</span> age = <span class="hljs-number">18</span><br><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sayHello</span>(<span class="hljs-params"></span>) </span>&#123;<br>    alert(<span class="hljs-string">`I am <span class="hljs-subst">$&#123;name&#125;</span>,I am <span class="hljs-subst">$&#123;age&#125;</span> years old`</span>)<br>  &#125;<br><br>  <span class="hljs-comment">// 在setup中数据需要return出去</span><br>  <span class="hljs-keyword">return</span>&#123;<br>    name,<br>    age,<br>    sayHello<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>return出来的数据可以在外部调用，也可以<code>return</code>一个渲染函数<code>render</code></p>
<p>而且在模板中引用时需要使用this.xxx而不是xxx.value</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>我是App组件<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>person:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">this.name</span>&#125;&#125;</span><span class="xml"> </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">this.age</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;sayHello&quot;</span>&gt;</span>hello<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>注意set up 不要和vue2中的data，method混用，会有优先级的问题</p>
<p><strong>set up也不能是一个async函数</strong>，被async修饰后我们得到的就是一个promise包裹的对象了，所以被禁止了。</p>
<p>但是后期我们学习了异步组件之后，异步组件中的setup可以是一个async函数</p>
<h3 id="3-2-ref"><a href="#3-2-ref" class="headerlink" title="3.2 ref"></a>3.2 ref</h3><p>ref在vue2中是一个属性，而在vue3中是一个函数，用于实现数据响应式</p>
<p>先引入ref</p>
<figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nim"><span class="hljs-keyword">import</span> &#123; <span class="hljs-keyword">ref</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>为了实现ref，我们在定义数据时需要</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">let</span> name = <span class="hljs-keyword">ref</span>(<span class="hljs-string">&quot;tony&quot;</span>)<br><span class="hljs-keyword">let</span> age = <span class="hljs-keyword">ref</span>(<span class="hljs-number">18</span>)<br></code></pre></td></tr></table></figure>

<p>这样ref将我们的数据转换成了一个对象</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sqf">RefImpl &#123;<span class="hljs-variable">__v_isShallow</span>: <span class="hljs-literal">false</span>, dep: <span class="hljs-built_in">Set</span>(<span class="hljs-number">1</span>), <span class="hljs-variable">__v_isRef</span>: <span class="hljs-literal">true</span>, <span class="hljs-variable">_rawValue</span>: <span class="hljs-string">&#x27;tony&#x27;</span>, <span class="hljs-variable">_value</span>: <span class="hljs-string">&#x27;tony&#x27;</span>&#125;<br>dep: <span class="hljs-built_in">Set</span>(<span class="hljs-number">1</span>) &#123;ReactiveEffect&#125;<br><span class="hljs-variable">__v_isRef</span>: <span class="hljs-literal">true</span><br><span class="hljs-variable">__v_isShallow</span>: <span class="hljs-literal">false</span><br><span class="hljs-variable">_rawValue</span>:<span class="hljs-string">&quot; 李四&quot;</span><br><span class="hljs-variable">_value</span>: <span class="hljs-string">&quot;李四&quot;</span><br>value: <span class="hljs-string">&quot;李四&quot;</span><br></code></pre></td></tr></table></figure>

<p>我们使用value值就可以调用setter，实现响应式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 设置响应式数据</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeHello</span>(<span class="hljs-params"></span>)</span>&#123;<br>      <span class="hljs-built_in">console</span>.log(name);<br>      name.value = <span class="hljs-string">&#x27;李四&#x27;</span>,<br>      age.value = <span class="hljs-number">48</span> <br>    &#125;<br></code></pre></td></tr></table></figure>



<p>我们还可以使用ref操作对象</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">let</span> job = ref(&#123;<br>  <span class="hljs-built_in">type</span>:<span class="hljs-string">&#x27;前端&#x27;</span>,<br>  salary:<span class="hljs-string">&#x27;30k&#x27;</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<p>但是修改对象中的数据使用的是 <code>   job.value.salary=&#39;60k&#39;</code>，</p>
<p>因为对象的封装不再是refimpl，而是proxy</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs lua">Proxy<br><span class="hljs-string">[[Handler]]</span>: Object<br><span class="hljs-string">[[Target]]</span>: Object<br>salary: <span class="hljs-string">&quot;60k&quot;</span><br><span class="hljs-built_in">type</span>: <span class="hljs-string">&quot;前端&quot;</span><br><span class="hljs-string">[[Prototype]: Object</span><br><span class="hljs-string">[[IsRevoked]]: false</span><br></code></pre></td></tr></table></figure>



<h3 id="3-3-reactive"><a href="#3-3-reactive" class="headerlink" title="3.3 reactive"></a>3.3 reactive</h3><p>reactive适用于管理对象和数组类型的数据，但不能用于管理基本数据类型</p>
<p>也是将对象封装成一个proxy</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">let</span> job = reactive(&#123;<br>  <span class="hljs-built_in">type</span>:<span class="hljs-string">&#x27;前端&#x27;</span>,<br>  salary:<span class="hljs-string">&#x27;30k&#x27;</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<p>更改数据的时候只需要</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable"><span class="hljs-class">job</span>.salary</span>=<span class="hljs-string">&#x27;60k&#x27;</span><br><span class="hljs-variable">console.log</span>(<span class="hljs-variable"><span class="hljs-class">job</span></span>)<br></code></pre></td></tr></table></figure>

<p>我们的ref管理的基本类型数据也可以通过封装成对象中的属性让reactive进行管理</p>
<p>在vue2中我们的新增和删除要体现在页面上需要使用</p>
<p>Vue.delete()和Vue.set()或者this.$set()和this.$delete()</p>
<p>vue3中的响应式，只要是reactive中管理的数据，我们就可以直接使用delete删除</p>
<p>vue3是通过proxy调用set和get进行数据的更改，deleteProperty实现删除</p>
<p><img src="https://img-blog.csdnimg.cn/f980aa564e374167936dbf70089df3ba.png" srcset="/img/loading.gif" lazyload alt="proxy"></p>
<p>在vue2中我们使用props实现父向子传值，子组件接收需要使用props</p>
<p>但是如果不使用props，我们也能在vc身上的<code>$attr</code>中看到</p>
<p>在vue3中setup的执行时间比beforeCreate早</p>
<p>而且setup中的this是undefined</p>
<p>setup中的参数第一个是 props第二个是context</p>
<h4 id="3-3-1使用自定义事件"><a href="#3-3-1使用自定义事件" class="headerlink" title="3.3.1使用自定义事件"></a>3.3.1使用自定义事件</h4><p>vue3中的自定义事件与vue2有区别</p>
<p>首先向子组件传值</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;setUp <span class="hljs-attribute">user</span>=<span class="hljs-string">&quot;pigeon&quot;</span> <span class="hljs-attribute">pwd</span>=<span class="hljs-string">&quot;123456&quot;</span> @<span class="hljs-attribute">hello</span>=<span class="hljs-string">&quot;hello&quot;</span>&gt;&lt;/setUp&gt;<br></code></pre></td></tr></table></figure>

<p>然后在子组件接收</p>
<p>注意与vue2不同vue3中需要使用emits属性获取传入的自定义事件，然后使用context参数（必须是把前面的props写上，因为context是第二个参数）触发传参</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript">    emits: [<span class="hljs-string">&#x27;hello&#x27;</span>],<br>    <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params">prop,context</span>)</span> &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hello</span>(<span class="hljs-params"></span>)</span>&#123;<br>            context.emit(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-number">666</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">return</span>&#123;<br>            hello<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-计算属性与监视"><a href="#4-计算属性与监视" class="headerlink" title="4.计算属性与监视"></a>4.计算属性与监视</h2><h3 id="4-1-computed"><a href="#4-1-computed" class="headerlink" title="4.1 computed"></a>4.1 computed</h3><p>vue3中也可以vue2的计算属性，但是不推荐</p>
<p>vue3中的计算属性需要引入然后写入在setup中</p>
<p>我们写一个案例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; reactive, computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;setUp&#x27;</span>,<br>    <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>        <span class="hljs-keyword">let</span> person = reactive(&#123;<br>            <span class="hljs-attr">firstName</span> : <span class="hljs-string">&#x27;tony&#x27;</span>,<br>            <span class="hljs-attr">lastName</span> : <span class="hljs-string">&#x27;stake&#x27;</span>,<br>        &#125;)<br><br>        <span class="hljs-comment">// //书写计算属性使用computed-简写形式</span><br>        <span class="hljs-comment">// person.fullName = computed(()=&gt;&#123;</span><br>        <span class="hljs-comment">//     return person.firstName+&#x27;-&#x27;+person.lastName</span><br>        <span class="hljs-comment">// &#125;)</span><br><br>        <span class="hljs-comment">// getter 和setter形式</span><br>        person.fullName = computed(&#123;<br>            <span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-keyword">return</span> person.firstName+<span class="hljs-string">&#x27;-&#x27;</span>+person.lastName<br>            &#125;,<br>            <span class="hljs-function"><span class="hljs-title">set</span>(<span class="hljs-params">newVal</span>)</span>&#123;<br>                <span class="hljs-keyword">const</span> nameArr = newVal.split(<span class="hljs-string">&#x27;-&#x27;</span>)<br>                person.firstName=nameArr[<span class="hljs-number">0</span>]<br>                person.lastName=nameArr[<span class="hljs-number">1</span>]<br>            &#125;<br>        &#125;)<br>        <span class="hljs-keyword">return</span>&#123;<br>            person<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>和vue2一样如果需要修改计算得到的值要把计算属性写成扩写形式，写出set方法</p>
<h3 id="4-2-监视属性"><a href="#4-2-监视属性" class="headerlink" title="4.2 监视属性"></a>4.2 监视属性</h3><h4 id="ref"><a href="#ref" class="headerlink" title="ref:"></a>ref:</h4><p>对ref使用监视属性监视简单数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; ref, watch &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;setUp&#x27;</span>,<br>    <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>        <span class="hljs-keyword">let</span> sum = ref(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">let</span> msg = ref(<span class="hljs-string">&#x27;hello&#x27;</span>)<br>        <span class="hljs-comment">//watch-情况一</span><br>        <span class="hljs-comment">// watch(sum, (newVal,oldVal)=&gt;&#123;</span><br>        <span class="hljs-comment">//     console.log(&quot;sum改变了&quot;+oldVal+newVal);</span><br>        <span class="hljs-comment">// &#125;)</span><br>        <br>        <span class="hljs-comment">//watch-情况二-监视多个</span><br>        watch([sum, msg], <span class="hljs-function">(<span class="hljs-params">newVal,oldVal</span>)=&gt;</span>&#123;<br>            <span class="hljs-built_in">console</span>.log(oldVal,newVal);<br>        &#125;)<br><br>        <span class="hljs-keyword">return</span>&#123;<br>            sum,<br>            msg<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注意情况二的数据，得到的oldVal和newVal是数组</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs prolog">[<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;hello&#x27;</span>] =&gt; [<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;hello&#x27;</span>]<br></code></pre></td></tr></table></figure>

<p>当需要打开深度监视和立即监视的时候在后面写配置项</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">watch(sum, <span class="hljs-function"><span class="hljs-params">(oldVal,newVal)</span>=&gt;</span>&#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;sum改变了&quot;</span>+oldVal+newVal);<br>&#125;,&#123;immediate:<span class="hljs-literal">true</span>, deep:<span class="hljs-literal">true</span>&#125;)<br></code></pre></td></tr></table></figure>



<h4 id="reactive："><a href="#reactive：" class="headerlink" title="reactive："></a>reactive：</h4><p>reactive操作对象数据</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">个人信息：&lt;input <span class="hljs-attribute">v-model</span>=<span class="hljs-string">&quot;person.name&quot;</span>/&gt;<br>&lt;br/&gt;<br>&lt;input <span class="hljs-attribute">v-model</span>=<span class="hljs-string">&quot;person.age&quot;</span>/&gt;<br></code></pre></td></tr></table></figure>

<p>我们使用reactive包裹一个对象</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-keyword">let</span> person = reactive(&#123;<br>   <span class="hljs-built_in"> name</span>:<span class="hljs-string">&#x27;on&#x27;</span>,<br>    age:<span class="hljs-string">&#x27;18&#x27;</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-comment">//watch-情况三-监视对象</span><br>watch(person,(oldVal,<span class="hljs-keyword">new</span><span class="hljs-type">Val</span>)=&gt;&#123;<br>    console.log(oldVal,<span class="hljs-keyword">new</span><span class="hljs-type">Val</span>);<br>&#125;)<br><br></code></pre></td></tr></table></figure>

<p>但是我们得到的数据是:</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-built_in">Proxy</span> &#123;name: <span class="hljs-string">&#x27;jkl&#x27;</span>, age: <span class="hljs-string">&#x27;18&#x27;</span>&#125; =&gt; <span class="hljs-built_in">Proxy</span> &#123;name: <span class="hljs-string">&#x27;jkl&#x27;</span>, age: <span class="hljs-string">&#x27;18&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>

<p>我们发现没有oldValue了，只有newValue，而且自动开启了<strong>深度监视</strong></p>
<p>如果我们需要使用oldValue就只有使用ref</p>
<p>还有几种情况：</p>
<p><img src="https://img-blog.csdnimg.cn/6a16a4068642451599baeaa80939acff.png" srcset="/img/loading.gif" lazyload alt="watch的几种情况"></p>
<p>注意一个特殊情况：这里的job是</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">job:</span>&#123;<br><span class="hljs-symbol">    j1:</span>&#123;<br><span class="hljs-symbol">        salary:</span><span class="hljs-string">&quot;1K&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>如果要监视一种属性，要监听里面的数据，要用到深度监视配置deep</strong></p>
<h4 id="value："><a href="#value：" class="headerlink" title="value："></a>value：</h4><p>我们使用ref包裹基本数据的时候，很多人会习惯了<code>.value</code>，但是在watch中，我们不能使用<code>.value</code>，因为value取到的是值，但是我们需要监视的是一个<code>RefImpl</code>的结构</p>
<p>但是如果我们包裹的是对象数据，<strong>情况就不一样了</strong>，我们就需要使用<code>.value</code>，因为对象中的<code>.value</code>是一个proxy，它才是真正的监听数据，一般的person只是一个内存地址</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">watch(person.value,<span class="hljs-function"><span class="hljs-params">(oldVal,newVal)</span>=&gt;</span>&#123;<br>   <span class="hljs-built_in">console</span>.log(oldVal,newVal);<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>还有一种不使用<code>.value</code>的方法，开启深度监视</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">watch(person,<span class="hljs-function"><span class="hljs-params">(oldVal,newVal)</span>=&gt;</span>&#123;<br>   <span class="hljs-built_in">console</span>.log(oldVal,newVal);<br>&#125;,&#123;deep: <span class="hljs-literal">true</span>&#125;)<br></code></pre></td></tr></table></figure>

<h4 id="watchEffect："><a href="#watchEffect：" class="headerlink" title="watchEffect："></a>watchEffect：</h4><p>vue3中的新属性</p>
<p>官方文档的定义：立即运行一个函数，同时响应式地追踪其依赖，并在依赖更改时重新执行。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">watchEffect(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>&#123;<br>    const x = person.name;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;name改变了&quot;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>我们发现我们更改person.name的时候，就会触发回调</p>
<p>只要我们在回调中用到的数据改变，就会触发回调</p>
<p>其实watchEffect有点类似computed，<strong>回调中依赖的数据变化，就会执行回调</strong></p>
<h3 id="5-生命周期"><a href="#5-生命周期" class="headerlink" title="5.生命周期"></a>5.生命周期</h3><p>生命周期大体上和vue2差不多，更新了两个钩子</p>
<p>取消了beforedestroy和destroy</p>
<p>更新了：</p>
<p>beforeUnmount</p>
<p>在一个组件实例被卸载之前调用。</p>
<ul>
<li><p><strong>类型</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">interface</span> <span class="hljs-symbol">ComponentOptions</span> &#123;<br>  beforeUnmount?(<span class="hljs-keyword">this</span>: ComponentPublicInstance): <span class="hljs-built_in">void</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><strong>详细信息</strong></p>
<p>当这个钩子被调用时，组件实例依然还保有全部的功能。</p>
<p><strong>这个钩子在服务端渲染时不会被调用。</strong></p>
</li>
</ul>
<p>和</p>
<p>unmounted</p>
<p>在一个组件实例被卸载之后调用。</p>
<ul>
<li><p><strong>类型</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">interface</span> <span class="hljs-symbol">ComponentOptions</span> &#123;<br>  unmounted?(<span class="hljs-keyword">this</span>: ComponentPublicInstance): <span class="hljs-built_in">void</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p><strong>详细信息</strong></p>
<p>一个组件在以下情况下被视为已卸载：</p>
<ul>
<li>其所有子组件都已经被卸载。</li>
<li>所有相关的响应式作用 (渲染作用以及 <code>setup()</code> 时创建的计算属性和侦听器) 都已经停止。</li>
</ul>
<p>可以在这个钩子中手动清理一些副作用，例如计时器、DOM 事件监听器或者与服务器的连接。</p>
<p><strong>这个钩子在服务端渲染时不会被调用。</strong></p>
</li>
</ul>
<p>一般形式和我们vue2中很像，所以我们这里介绍</p>
<h4 id="组合式API："><a href="#组合式API：" class="headerlink" title="组合式API："></a>组合式API：</h4><p><img src="https://img-blog.csdnimg.cn/52b001236b4a44d3a4ccd04717c00103.png" srcset="/img/loading.gif" lazyload alt="生命周期组件式API"></p>
<p>导入之后就可以在setUp中写</p>
<p>导入：<code>import &#123; reactive, ref, onBeforeMount &#125; from &#39;vue&#39;;</code></p>
<p>使用：（在setup中）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">let</span> sum = ref(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">let</span> msg = ref(<span class="hljs-string">&#x27;hello&#x27;</span>)<br>    <span class="hljs-keyword">let</span> person = reactive(&#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;on&#x27;</span>,<br>        <span class="hljs-attr">age</span>:<span class="hljs-string">&#x27;18&#x27;</span>,<br>        <span class="hljs-attr">job</span>:&#123;<br>            <span class="hljs-attr">j1</span>:&#123;<br>                <span class="hljs-attr">salary</span>:<span class="hljs-string">&quot;1K&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;)<br>    <br>    onBeforeMount(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;===onBeforeMount===&quot;</span>);<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span>&#123;<br>        sum,<br>        msg,<br>        person,<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>但是不提倡组合式api和函数式混用，导致项目结构不清晰</p>
<h3 id="6-hook"><a href="#6-hook" class="headerlink" title="6.hook"></a>6.hook</h3><p>hook是一个函数，在setup中对组合式api进行封装</p>
<p>比如我们需要一个获取鼠标坐标的函数，这种函数如果经常用到，我们就需要将它写成模块</p>
<p>这个模块就是hook</p>
<p>新建一个src/hook文件夹：写入文件<code>usePoint.js</code></p>
<p><strong>引入，暴露，函数，返回值都要有</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; reactive, onMounted, onBeforeUnmount &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">let</span> points = reactive(&#123;<br>        <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,<br>    &#125;)<br><br>    <span class="hljs-comment">//自定义函数</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">savePoint</span>(<span class="hljs-params">event</span>) </span>&#123;<br>        points.x = event.pageX;<br>        points.y = event.pageY;<br>        <span class="hljs-built_in">console</span>.log(points.x+<span class="hljs-string">&quot; &quot;</span>+points.y);<br>    &#125;<br><br>    <span class="hljs-comment">//生命周期钩子</span><br>    onMounted(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&#x27;click&#x27;</span>, savePoint)<br>    &#125;)<br><br>    <span class="hljs-comment">//销毁钩子</span><br>    onBeforeUnmount(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">&#x27;click&#x27;</span>, savePoint)<br>    &#125;)<br><br>    <span class="hljs-comment">//因为要作为函数调用，最后要返回出去</span><br>    <span class="hljs-keyword">return</span> points<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后这个模块可以在</p>
<p>组件中被引入，然后通过函数调用</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">当前求和为：</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">sum</span>&#125;&#125;</span><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;sum++&quot;</span>&gt;</span>点我加1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span></span><br><span class="xml">获取当前鼠标坐标：X:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">points.x</span>&#125;&#125;</span><span class="xml">,y:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">points.y</span>&#125;&#125;</span><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">import</span> usePoint <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/hooks/usePoint&#x27;</span>;</span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">import</span> &#123; ref, &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;</span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;setUp&#x27;</span>,</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">let</span> sum = ref(<span class="hljs-number">0</span>)</span></span><br><span class="javascript"><span class="xml">        </span></span><br><span class="javascript"><span class="xml">        <span class="hljs-comment">//获取hook中的调用</span></span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">let</span> points = usePoint() </span></span><br><span class="javascript"><span class="xml"></span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">return</span>&#123;</span></span><br><span class="javascript"><span class="xml">            sum,</span></span><br><span class="javascript"><span class="xml">            points</span></span><br><span class="javascript"><span class="xml">        &#125;</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure>



<h3 id="7-toRef"><a href="#7-toRef" class="headerlink" title="7.toRef"></a>7.toRef</h3><p>当我们需要单独将一个reactive对象中的一个属性比如：name拿出来使用的时候</p>
<p>如果使用</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">return</span> &#123;<br>	<span class="hljs-built_in">name</span>: person.<span class="hljs-built_in">name</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>就会出现丢失了响应式的问题，所以我们需要使用到toRef</p>
<p>有需要和之前的person产生联系使用</p>
<p>相当于一个浅拷贝，有引用关系和指针指向问题</p>
<p><img src="https://img-blog.csdnimg.cn/970ce1664f8348f7b256f950b8eb78c0.png" srcset="/img/loading.gif" lazyload alt="toRef"></p>
<p>或者可以使用<code>toRefs</code>对一个对象的数据进行toRef操作，如果是有深度的数据就需要使用的时候加上层级关系</p>
<p>但是return的时候需要使用<code>...toRefs(xxx)</code>，展开来进行返回</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;toRefs&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;App&#x27;</span><br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">let</span> obj = &#123;<span class="hljs-attr">name</span> : <span class="hljs-string">&#x27;alice&#x27;</span>, <span class="hljs-attr">age</span> : <span class="hljs-number">12</span>&#125;;<br>    <span class="hljs-keyword">let</span> newObj= toRefs(obj);	<span class="hljs-comment">//相当于将obj中所有的元素都执行了一遍toRef</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params"></span>)</span>&#123;<br>      newObj.name.value = <span class="hljs-string">&#x27;Tom&#x27;</span>;<br>      newObj.age.value = <span class="hljs-number">18</span>;<br>      <span class="hljs-built_in">console</span>.log(obj,newObj)<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;newObj,change&#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="5-其他组合式api"><a href="#5-其他组合式api" class="headerlink" title="5. 其他组合式api"></a>5. 其他组合式api</h2><h3 id="1-shallowRef-and-shallowReactive（性能优化）"><a href="#1-shallowRef-and-shallowReactive（性能优化）" class="headerlink" title="1. shallowRef and shallowReactive（性能优化）"></a>1. shallowRef and shallowReactive（性能优化）</h3><p>shallow也就是浅层的意思，顾名思义，<strong>shallowReactive只处理对象浅层的数据的响应式，shallowRef只处理基本类型的数据响应式，不处理对象类型的数据的响应式</strong></p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>此时x的值为：</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">x.y</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;x.y++&quot;</span>&gt;</span>点我x.y+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>此时p1的值为：</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">sr.p1</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>此时p2.p3的值为：</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">sr.p2.p3</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;sr.p1++&quot;</span>&gt;</span>点击p1+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click-</span>=<span class="hljs-string">&quot;sr.p2.p3++&quot;</span>&gt;</span>点击p3+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">  </span><br><span class="xml">import &#123;reactive, shallowReactive, shallowRef, toRefs&#125; from &#x27;vue&#x27;;</span><br><span class="xml">export default &#123;</span><br><span class="xml">  name: &#x27;setUp&#x27;,</span><br><span class="xml">  setup() &#123;</span><br><span class="xml">    let x = shallowRef(&#123;</span><br><span class="xml">      y : 1</span><br><span class="xml">    &#125;)</span><br><span class="xml"></span><br><span class="xml">    let sr = shallowReactive(&#123;</span><br><span class="xml">      p1:1,</span><br><span class="xml">      p2:&#123;</span><br><span class="xml">        p3: 1</span><br><span class="xml">      &#125;</span><br><span class="xml">    &#125;)</span><br><span class="xml">    </span><br><span class="xml">    return&#123;</span><br><span class="xml">      x,</span><br><span class="xml">      sr</span><br><span class="xml">    &#125;</span><br><span class="xml">  &#125;</span><br><span class="xml">&#125;</span><br></code></pre></td></tr></table></figure>

<p>我们得到的结果是x.y 和p2.p3的值都不会改变 ，但是 p1的值会改变，说明了shallow的浅层响应式的作用</p>
<h3 id="2-readOnly"><a href="#2-readOnly" class="headerlink" title="2. readOnly"></a>2. readOnly</h3><p>使用readOnly包裹一个数据，使其变成只读的数据，我们将person改为只读数据</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">let</span> <span class="hljs-string">person = reactive(&#123;</span><br>  <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;on&#x27;,</span><br>  <span class="hljs-attr">age</span>:<span class="hljs-string">&#x27;18&#x27;,</span><br>  <span class="hljs-attr">job</span>:<span class="hljs-string">&#123;</span><br>    <span class="hljs-attr">j1</span>:<span class="hljs-string">&#123;</span><br>      <span class="hljs-attr">salary</span>:<span class="hljs-string">&quot;1K&quot;</span><br>    <span class="hljs-attr">&#125;</span><br>  <span class="hljs-attr">&#125;</span><br><span class="hljs-attr">&#125;)</span><br><br><span class="hljs-attr">person</span> = <span class="hljs-string">readonly(person)</span><br></code></pre></td></tr></table></figure>

<p>此时再更改person中的数据的时候，就会失败而且控制台出现警告</p>
<p><code>Set operation on key &quot;name&quot; failed: target is readonly. </code></p>
<p>shallowReadOnly</p>
<p>带有shallow的都是浅层的意思，那么shallowReadOnly就代表只把浅层的数据改为readOnly的形式</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">let</span> <span class="hljs-string">person = reactive(&#123;</span><br>  <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;on&#x27;,</span><br>  <span class="hljs-attr">age</span>:<span class="hljs-string">&#x27;18&#x27;,</span><br>  <span class="hljs-attr">job</span>:<span class="hljs-string">&#123;</span><br>    <span class="hljs-attr">j1</span>:<span class="hljs-string">&#123;</span><br>      <span class="hljs-attr">salary</span>:<span class="hljs-string">&quot;1K&quot;</span><br>    <span class="hljs-attr">&#125;</span><br>  <span class="hljs-attr">&#125;</span><br><span class="hljs-attr">&#125;)</span><br><br><span class="hljs-attr">person</span> = <span class="hljs-string">shallowReadonly(person)</span><br></code></pre></td></tr></table></figure>

<p><strong>这样person内层的数据还是可以改变，但是外层的数据已经不能改变了。</strong></p>
<h3 id="3-toRaw-and-markRaw"><a href="#3-toRaw-and-markRaw" class="headerlink" title="3. toRaw and markRaw"></a>3. toRaw and markRaw</h3><p>raw类方法实现的是<strong>将响应式数据变为普通数据</strong>，也就是取消响应式效果（proxy代理）</p>
<p>toRaw: 简单的取消响应式</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">person = <span class="hljs-keyword">to</span><span class="hljs-constructor">Raw(<span class="hljs-params">person</span>)</span><br></code></pre></td></tr></table></figure>

<p>markRaw: 将一个数据永远不设置为响应式</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>给person添加car属性，但car属性不会更改<br><span class="hljs-keyword">function</span> addCar()&#123;<br>  let car = &#123;brand: <span class="hljs-string">&#x27;奔驰&#x27;</span>, price: <span class="hljs-string">&#x27;40w&#x27;</span>&#125;<br>  <span class="hljs-regexp">//m</span>arkRaw使得数据永远不会变为响应式<br>  person.car = markRaw(car)<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="4-customRef"><a href="#4-customRef" class="headerlink" title="4. customRef"></a>4. customRef</h3><p>customRef实现自定义Ref，什么是自定义ref呢？如下代码</p>
<p>其中的myRef就是我们自定义的ref，需要由我们来维护</p>
<p>而维护这个ref就需要<strong>使用customRef自己来写响应式的get和set</strong></p>
<p>我们在set中设置了延迟显示，晚一秒再触发trigger模型解析</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//自定义ref</span><br>   <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myRef</span>(<span class="hljs-params">value</span>)</span>&#123;<br>     <span class="hljs-keyword">let</span> timer<br>   <span class="hljs-comment">//  使用customRef实现自定义ref</span><br>     <span class="hljs-keyword">return</span> customRef(<span class="hljs-function">(<span class="hljs-params">track, trigger</span>)=&gt;</span>&#123;<br>       <span class="hljs-comment">//需要return一个对象</span><br>       <span class="hljs-keyword">return</span>&#123;<br>         <span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span>&#123;<br><br>           <span class="hljs-comment">//将myRef中的value返回出去实现get</span><br>           <span class="hljs-comment">//track实现get的多次调用</span><br>           track()<br>           <span class="hljs-keyword">return</span> value<br>         &#125;,<br>         <span class="hljs-function"><span class="hljs-title">set</span>(<span class="hljs-params">newValue</span>)</span>&#123;<br>           <span class="hljs-comment">//set可以获取一个newValue参数</span><br>           <span class="hljs-built_in">clearTimeout</span>(timer)<br>           timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>             value = newValue<br>             <span class="hljs-comment">//trigger实现模板的重新解析</span><br>             trigger()<br>           &#125;,<span class="hljs-number">1000</span>)<br>         &#125;<br>       &#125;<br>     &#125;)<br>   &#125;<br><br>   <span class="hljs-keyword">let</span> hello = myRef(<span class="hljs-string">&quot;hello&quot;</span>);<br>   <span class="hljs-keyword">return</span>&#123;<br>       hello<br>   &#125;<br></code></pre></td></tr></table></figure>

<p>可是问题是：<strong>如果更改速度过快或者过多，就会触发很多定时器，产生抖动</strong></p>
<p>所以我们需要在创建一个定时器前清除上一个定时器，保证只有一个定时器</p>
<p>或者<strong>我们使用setTimeInterval，循环触发trigger</strong></p>
<h3 id="5-provide-inject"><a href="#5-provide-inject" class="headerlink" title="5. provide inject"></a>5. provide inject</h3><p>这两个api用于祖孙组件间通信</p>
<p>祖组件：使用provide将需要传输的数据传递出去</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">let</span> car = reactive(&#123;<span class="hljs-attr">brand</span>:<span class="hljs-string">&quot;BMW&quot;</span>, <span class="hljs-attr">price</span>:<span class="hljs-string">&quot;40w&quot;</span>&#125;)<br>  provide(<span class="hljs-string">&quot;car&quot;</span>,car)<br>  <span class="hljs-keyword">return</span>&#123;<br>    car<br>  &#125;<br>&#125;,<br></code></pre></td></tr></table></figure>

<p>孙组件：使用inject获取传出的数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-keyword">let</span> x = inject(<span class="hljs-string">&quot;car&quot;</span>)<br>  <span class="hljs-built_in">console</span>.log(x)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="6-判断是否为响应式"><a href="#6-判断是否为响应式" class="headerlink" title="6.判断是否为响应式"></a>6.判断是否为响应式</h3><p>使用isRef，isReactive，isReadOnly，isProxy </p>
<p>分别代表是否是ref等，和是否是Proxy代理的对象</p>
<h3 id="7-vue3新组件"><a href="#7-vue3新组件" class="headerlink" title="7.vue3新组件"></a>7.vue3新组件</h3><h4 id="1-fragment"><a href="#1-fragment" class="headerlink" title="1.fragment"></a>1.fragment</h4><p>一个vue3中的标签，不参与渲染，比如vue2中vue标签需要一个div包裹整个template，但是vue3中不需要而是一个隐藏的fragment</p>
<h4 id="2-Teleport"><a href="#2-Teleport" class="headerlink" title="2.Teleport"></a>2.Teleport</h4><p>也是新标签，用于将组件中的dom节点传送到指定的地方</p>
<p>在我们的文件结构中，父元素是App，子元素是child，孙元素是sun，孙元素拥有一个组件dialog-实现弹窗对话的效果</p>
<p><strong>dialog组件：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;isShow=true&quot;</span>&gt;</span>点我显示弹窗<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;isShow&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dialog&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>对话1<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>对话2<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;isShow=false&quot;</span>&gt;</span>点击关闭弹窗<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span><br><span class="javascript"><span class="hljs-keyword">import</span> &#123;ref&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;</span><br><span class="javascript"></span><br><span class="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="javascript">  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;dialog&quot;</span>,</span><br><span class="javascript">  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">    <span class="hljs-keyword">let</span> isShow = ref(<span class="hljs-literal">false</span>)</span><br><span class="javascript">    <span class="hljs-keyword">return</span>&#123;</span><br><span class="javascript">      isShow</span><br><span class="javascript">    &#125;</span><br><span class="javascript">  &#125;</span><br><span class="javascript">&#125;</span><br><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css"></span><br><span class="css">  <span class="hljs-selector-class">.dialog</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;</span><br><span class="css">    <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;</span><br><span class="css">    <span class="hljs-attribute">background-color</span>: aliceblue;</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>但是问题就在于，这时对话框默认是在sun组件里的，如果使用定位调节，也会有很多的repaint的问题</p>
<p>所以我们使用teleport实现传送：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">&lt;teleport to=<span class="hljs-string">&quot;body&quot;</span>&gt;<br>  &lt;div v-<span class="hljs-keyword">if</span>=<span class="hljs-string">&quot;isShow&quot;</span> <span class="hljs-keyword">class</span>=&quot;<span class="hljs-symbol">dialog</span>&quot;&gt;<br>    &lt;<span class="hljs-symbol">h3</span>&gt;对话<span class="hljs-symbol">1</span>&lt;/<span class="hljs-symbol">h3</span>&gt;<br>    &lt;<span class="hljs-symbol">h3</span>&gt;对话<span class="hljs-symbol">2</span>&lt;/<span class="hljs-symbol">h3</span>&gt;<br>    &lt;<span class="hljs-symbol">button</span> @<span class="hljs-symbol">click</span>=&quot;<span class="hljs-symbol">isShow</span>=<span class="hljs-symbol">false</span>&quot;&gt;点击关闭弹窗&lt;/<span class="hljs-symbol">button</span>&gt;<br>  &lt;/<span class="hljs-symbol">div</span>&gt;<br>&lt;/<span class="hljs-symbol">teleport</span>&gt;<br></code></pre></td></tr></table></figure>

<p>这样我们再写样式，<strong>这个dom节点就是依靠body来进行定位</strong></p>
<h4 id="3-Suspence"><a href="#3-Suspence" class="headerlink" title="3.Suspence"></a>3.Suspence</h4><p>也是一个内置的标签组件，用于<strong>解决异步组件中由于加载快慢引起的抖动问题</strong></p>
<p>首先引入异步组件：同步组件都是一起显示，等到所有的子组件都加在完毕之后再进行加载</p>
<p>​                                而异步组件不同，异步组件是根据层级顺序进行加载，优先加载父组件，加载一个显示一个</p>
<p>​                                <strong>而且异步组件中可以使用异步promise函数作为setup的返回对象，setup也可以是async函数</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//静态引入-异步组件生成函数</span><br><span class="hljs-keyword">import</span> &#123;defineAsyncComponent&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">const</span> Child = defineAsyncComponent(<span class="hljs-function">()=&gt;</span><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./components/child&#x27;</span>))<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;App&quot;</span>,<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span>&#123;&#125;<br>  &#125;,<br>  <span class="hljs-attr">components</span>: &#123; Child &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>为解决异步组件的抖动问题：我们需要Suspence，Suspence其实类似于插槽，需要使用v-slot</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>我是App组件<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">suspense</span>&gt;</span><br><span class="hljs-comment">&lt;!--    默认组件--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:default</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">Child</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Child</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-comment">&lt;!--    默认组件还在加载时显示的备用组件--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:fallback</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>组件加载中》》》<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">suspense</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="8-router"><a href="#8-router" class="headerlink" title="8. router"></a>8. router</h3><p>使用router进行跳转等操作</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">import</span> &#123; useRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br></code></pre></td></tr></table></figure>

<p>3.用router.push跳转页面</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> 字符串<br>router.push(<span class="hljs-string">&#x27;home&#x27;</span>)<br><br><span class="hljs-regexp">//</span> 对象<br>router.push(&#123; path: <span class="hljs-string">&#x27;home&#x27;</span> &#125;)<br><br><span class="hljs-regexp">//</span> 命名的路由<br>router.push(&#123; name: <span class="hljs-string">&#x27;user&#x27;</span>, params: &#123; userId: <span class="hljs-string">&#x27;123&#x27;</span> &#125;&#125;)<br><br><span class="hljs-regexp">//</span> 带查询参数，变成 /register?userId=<span class="hljs-number">123</span><br>router.push(&#123; path: <span class="hljs-string">&#x27;register&#x27;</span>, query: &#123; userId: <span class="hljs-string">&#x27;123&#x27;</span> &#125;&#125;)<br></code></pre></td></tr></table></figure>

<p>4.如果有参数的话，在接收页面引入API–useRoute</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">import</span> &#123; useRoute &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br></code></pre></td></tr></table></figure>

<p>5.在接收页面定义变量route，获取传过来的变量</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pf">//首先在setup中定义<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">route</span> = useRoute()<br>//query<br>let <span class="hljs-keyword">user</span>Id=<span class="hljs-keyword">route</span>.query.<span class="hljs-keyword">user</span>Id;<br><br>//params<br>let <span class="hljs-keyword">user</span>Id=<span class="hljs-keyword">route</span>.params.<span class="hljs-keyword">user</span>Id;<br></code></pre></td></tr></table></figure>



<h2 id="…some-tips"><a href="#…some-tips" class="headerlink" title="…some tips"></a>…some tips</h2><h3 id="1-vue3全局挂载"><a href="#1-vue3全局挂载" class="headerlink" title="1.vue3全局挂载"></a>1.vue3全局挂载</h3><p>在vue2中使用全局挂载是直接调用Vue的原型（prototype）</p>
<p>但是vue3中，我们不再创建vue实例，所以无法在原型上做更改</p>
<p>一些全局的配置都做了替换：</p>
<p><img src="https://img-blog.csdnimg.cn/4a93f07bf2ac4cee80cbd864888ab3e2.png" srcset="/img/loading.gif" lazyload alt="全局配置"></p>
<p>我们引进一个全新的函数 <code>config.globalProperties</code></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">const</span> <span class="hljs-keyword">app</span> = createApp(<span class="hljs-keyword">App</span>)<br><span class="hljs-keyword">app</span>.config.globalProperties.<span class="hljs-variable">$axios</span> = axios<br><span class="hljs-keyword">app</span>.mount(&#x27;#<span class="hljs-keyword">app</span>&#x27;)<br></code></pre></td></tr></table></figure>

<p>这样也可以实现全局挂载的效果</p>
<h3 id="2-跨域配置"><a href="#2-跨域配置" class="headerlink" title="2.跨域配置"></a>2.跨域配置</h3><p>vue3的跨域问题配置也是同vue2一样在vue.config.js中（没有就创建一个）</p>
<p>其中target中相当于<code>baseurl</code>是跳转的一个默认地址</p>
<p><code>changOrigin: true,</code>实现我们允许跨域的效果</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>vue.config.js<br><br>module.exports = &#123;<br>    devServer: &#123;<br>      open: true, <span class="hljs-regexp">//</span>是否自动弹出浏览器页面<br>      <span class="hljs-regexp">//</span> host: <span class="hljs-string">&quot;localhost&quot;</span>,<br>      <span class="hljs-regexp">//</span> port: <span class="hljs-string">&#x27;8080&#x27;</span>,<br>      proxy: &#123;  <span class="hljs-regexp">//</span>配置跨域，可以配置多个跨域<br>      <span class="hljs-string">&#x27;/api&#x27;</span>: &#123;<br>        target: <span class="hljs-string">&#x27;http://127.0.0.1/&#x27;</span>,  <span class="hljs-regexp">//</span>这里后台的地址模拟的;应该填写你们真实的后台接口<br>        changOrigin: true,  <span class="hljs-regexp">//</span>允许跨域<br>        pathRewrite: &#123;<br>          <span class="hljs-regexp">/* 重写路径，当我们在浏览器中看到请求的地址为：http:/</span><span class="hljs-regexp">/localhost:8080/</span>api<span class="hljs-regexp">/core/g</span>etData/userInfo 时<br>            实际上访问的地址是：http:<span class="hljs-regexp">//</span><span class="hljs-number">121.121</span>.<span class="hljs-number">67.254</span>:<span class="hljs-number">8185</span><span class="hljs-regexp">/core/g</span>etData<span class="hljs-regexp">/userInfo,因为重写了 /</span>api<br>           */<br>          <span class="hljs-string">&#x27;^/api&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span> <br>        &#125;<br>      &#125;,<br>    &#125;<br>  &#125;,<br>  &#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-获取全局实例"><a href="#3-获取全局实例" class="headerlink" title="3.获取全局实例"></a>3.获取全局实例</h3><p>因为vue3中setup不能使用this</p>
<p>所以为了获取我们全局挂载上的方法，我们需要使用<code>getCurrentInstance</code></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-keyword">const</span> &#123;proxy&#125; = getCurrentInstance()<br><br><span class="hljs-keyword">const</span> $axios = proxy.$axios<br></code></pre></td></tr></table></figure>

<h3 id="4-移除keyCode作为v-on的修饰符"><a href="#4-移除keyCode作为v-on的修饰符" class="headerlink" title="4.移除keyCode作为v-on的修饰符"></a>4.移除keyCode作为v-on的修饰符</h3><h3 id="5-reactive丢失响应式"><a href="#5-reactive丢失响应式" class="headerlink" title="5. reactive丢失响应式"></a>5. reactive丢失响应式</h3><p>reactive重新赋值之后会丢失响应式</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs lasso">场景:<br><span class="hljs-number">1.</span>你定义了一个数据:<span class="hljs-keyword">let</span> <span class="hljs-built_in">data</span>=reactive(&#123;<br>          name:<span class="hljs-string">&quot;&quot;</span>,<br>          age:<span class="hljs-string">&quot;&quot;</span><br>&#125;)<br><span class="hljs-number">2.</span>然后你请求了接口，赋值给<span class="hljs-built_in">data</span><br><span class="hljs-keyword">let</span> res=await getUserApi();  <span class="hljs-comment">//请求接口</span><br><span class="hljs-built_in">data</span>=res.<span class="hljs-built_in">data</span>;   <br></code></pre></td></tr></table></figure>

<p>这样在data就会变为普通对象，丢失自己的响应式</p>
<p>1.ref 定义数据（包括对象）时，都会变成 RefImpl(Ref 引用对象) 类的实例，无论是修改还是重新赋值都会调用 setter，都会经过 reactive 方法处理为响应式对象。</p>
<p>2.但是 reactive 定义数据（必须是对象），是直接调用 reactive 方法处理成响应式对象。如果重新赋值，就会丢失原来响应式对象的引用地址，变成一个新的引用地址，这个新的引用地址指向的对象是没有经过 reactive 方法处理的，所以是一个普通对象，而不是响应式对象。解构同理。</p>
<p>解决方法：</p>
<p>1.嵌套对象</p>
<p>顾名思义，在data中嵌套一个对象datain，用它来实现我们的响应式就可以了</p>
<p><code>data.datain = res.data</code></p>
<p>2.Ts的类解决方案</p>
<p>按下不表</p>
<p>究竟怎样的结局配得上这一路颠沛流离</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/vue/" class="category-chain-item">vue</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/vue/">#vue</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Vue3</div>
      <div>http://yoursite.com/2022/06/06/Vue3/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Tspigeon</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年6月6日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/06/16/%E4%B8%AA%E4%BA%BA%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="Own Server">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Own Server</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/06/%E6%89%8B%E5%86%99Promise/" title="手写Promise">
                        <span class="hidden-mobile">手写Promise</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>No pigeon</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/yinghua.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/love.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
